<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Run the performance comparison between differential expression methods. — runComparison • compcodeR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Run the performance comparison between differential expression methods. — runComparison" />
<meta property="og:description" content="The main function for performing comparisons among differential expression methods and generating a report in HTML format. It is assumed that all differential expression results have been generated in advance (using e.g. the function runDiffExp) and that the result compData object for each data set and each differential expression method is saved separately in files with the extension .rds. Note that the function can also be called via the runComparisonGUI function, which lets the user set parameters and select input files using a graphical user interface." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">compcodeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.25.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/compcodeR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/csoneson/compcodeR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run the performance comparison between differential expression methods.</h1>
    <small class="dont-index">Source: <a href='https://github.com/csoneson/compcodeR/blob/master/R/runComparison.R'><code>R/runComparison.R</code></a></small>
    <div class="hidden name"><code>runComparison.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The main function for performing comparisons among differential expression methods and generating a report in HTML format. It is assumed that all differential expression results have been generated in advance (using e.g. the function <code><a href='runDiffExp.html'>runDiffExp</a></code>) and that the result <code>compData</code> object for each data set and each differential expression method is saved separately in files with the extension <code>.rds</code>. Note that the function can also be called via the <code><a href='runComparisonGUI.html'>runComparisonGUI</a></code> function, which lets the user set parameters and select input files using a graphical user interface.</p>
    </div>

    <pre class="usage"><span class='fu'>runComparison</span>(
  <span class='no'>file.table</span>,
  <span class='no'>parameters</span>,
  <span class='no'>output.directory</span>,
  <span class='kw'>check.table</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>out.width</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>file.table</th>
      <td><p>A data frame with at least a column <code>input.files</code>, potentially also columns named <code>datasets</code>, <code>nbr.samples</code>, <code>repl</code> and <code>de.methods</code>.</p></td>
    </tr>
    <tr>
      <th>parameters</th>
      <td><p>A list containing parameters for the comparison study. The following entries are supported, and used by different comparison methods:</p><ul>
<li><p><code>incl.nbr.samples</code> An array with sample sizes (number of samples per condition) to consider in the comparison. If set to <code>NULL</code>, all sample sizes will be included.</p></li>
<li><p><code>incl.dataset</code> A dataset name (corresponding to the <code>dataset</code> slot of the results or data objects), indicating the dataset that will be used for the comparison. Only one dataset can be chosen.</p></li>
<li><p><code>incl.replicates</code> An array with replicate numbers to consider in the comparison. If set to <code>NULL</code>, all replicates will be included.</p></li>
<li><p><code>incl.de.methods</code> An array with differential expression methods to be compared. If set to <code>NULL</code>, all differential expression methods will be included.</p></li>
<li><p><code>fdr.threshold</code> The adjusted p-value threshold for FDR calculations. Default 0.05.</p></li>
<li><p><code>tpr.threshold</code> The adjusted p-value threshold for TPR calculations. Default 0.05.</p></li>
<li><p><code>mcc.threshold</code> The adjusted p-value threshold for MCC calculations. Default 0.05.</p></li>
<li><p><code>typeI.threshold</code> The nominal p-value threshold for type I error calculations. Default 0.05.</p></li>
<li><p><code>fdc.maxvar</code> The maximal number of variables to include in false discovery curve plots. Default 1500.</p></li>
<li><p><code>overlap.threshold</code> The adjusted p-value for overlap analysis. Default 0.05.</p></li>
<li><p><code>fracsign.threshold</code> The adjusted p-value for calculation of the fraction/number of genes called significant. Default 0.05.</p></li>
<li><p><code>nbrtpfp.threshold</code> The adjusted p-value for calculation of the number of TP, FP, TN, FN genes. Default 0.05.</p></li>
<li><p><code>ma.threshold</code> The adjusted p-value threshold for coloring genes in MA plots. Default 0.05.</p></li>
<li><p><code>signal.measure</code> Either <code>'mean'</code> or <code>'snr'</code>, determining how to define the signal strength for a gene which is expressed in only one condition.</p></li>
<li><p><code>upper.limits,lower.limits</code> Lists that can be used to manually set the upper and lower plot limits for boxplots of fdr, tpr, auc, mcc, fracsign, nbrtpfp and typeIerror.</p></li>
<li><p><code>comparisons</code> Array containing the comparison methods to be applied. The entries must be chosen among the following abbreviations:</p><ul>
<li><p><code>"auc"</code> - Compute the area under the ROC curve</p></li>
<li><p><code>"mcc"</code> - Compute Matthew's correlation coefficient</p></li>
<li><p><code>"tpr"</code> - Compute the true positive rate at a given adjusted p-value threshold (<code>tpr.threshold</code>)</p></li>
<li><p><code>"fdr"</code> - Compute the false discovery rate at a given adjusted p-value threshold (<code>fdr.threshold</code>)</p></li>
<li><p><code>"fdrvsexpr"</code> - Compute the false discovery rate as a function of the expression level.</p></li>
<li><p><code>"typeIerror"</code> - Compute the type I error rate at a given nominal p-value threshold (<code>typeI.threshold</code>)</p></li>
<li><p><code>"fracsign"</code> - Compute the fraction of genes called significant at a given adjusted p-value threshold (<code>fracsign.threshold</code>).</p></li>
<li><p><code>"nbrsign"</code> - Compute the number of genes called significant at a given adjusted p-value threshold (<code>fracsign.threshold</code>).</p></li>
<li><p><code>"nbrtpfp"</code> - Compute the number of true positives, false positives, true negatives and false negatives at a given adjusted p-value threshold (<code>nbrtpfp.threshold</code>).</p></li>
<li><p><code>"maplot"</code> - Construct MA plots, depicting the average expression level and the log fold change for the genes and indicating the genes called differential expressed at a given adjusted p-value threshold (<code>ma.threshold</code>).</p></li>
<li><p><code>"fdcurvesall"</code> - Construct false discovery curves for each of the included replicates.</p></li>
<li><p><code>"fdcurvesone"</code> - Construct false discovery curves for a single replicate only</p></li>
<li><p><code>"rocall"</code> - Construct ROC curves for each of the included replicates</p></li>
<li><p><code>"rocone"</code> - Construct ROC curves for a single replicate only</p></li>
<li><p><code>"overlap"</code> - Compute the overlap between collections of genes called differentially expressed by the different methods at a given adjusted p-value threshold (<code>overlap.threshold</code>)</p></li>
<li><p><code>"sorensen"</code> - Compute the Sorensen index, quantifying the overlap between collections of genes called differentially expressed by the different methods, at a given adjusted p-value threshold (<code>overlap.threshold</code>)</p></li>
<li><p><code>"correlation"</code> - Compute the Spearman correlation between gene scores assigned by different methods</p></li>
<li><p><code>"scorevsoutlier"</code> - Visualize the distribution of the gene scores as a function of the number of outlier counts introduced for the genes</p></li>
<li><p><code>"scorevsexpr"</code> - Visualize the gene scores as a function of the average expression level of the genes</p></li>
<li><p><code>"scorevssignal"</code> - Visualize the gene score as a function of the 'signal strength' (see the <code>signal.measure</code> parameter above) for genes that are expressed in only one condition</p></li>
</ul></li>
</ul></td>
    </tr>
    <tr>
      <th>output.directory</th>
      <td><p>The directory where the results should be written. The subdirectory structure will be created automatically. If the directory already exists, it will be overwritten.</p></td>
    </tr>
    <tr>
      <th>check.table</th>
      <td><p>Logical, should the input table be checked for consistency. Default <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>out.width</th>
      <td><p>The width of the figures in the final report. Will be passed on to <code>knitr</code> when the HTML is generated.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function will create a comparison report, named <strong>compcodeR_report&lt;timestamp&gt;.html</strong>, in the <code>output.directory</code>. It will also create subfolders named <code>compcodeR_code</code> and <code>compcodeR_figure</code>, where the code used to perform the differential expression analysis and the figures contained in the report, respectively, will be stored. Note that if these directories already exists, they will be overwritten.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The input to <code>runComparison</code> is a data frame with at least a column named <code>input.files</code>, containing paths to <code>.rds</code> files containing result objects (of the class <code>compData</code>), such as those generated by <code><a href='runDiffExp.html'>runDiffExp</a></code>. Other columns that can be included in the data frame are <code>datasets</code>, <code>nbr.samples</code>, <code>repl</code> and <code>de.methods</code>. They have to match the information contained in the corresponding result objects. If these columns are not present, they will be added to the data frame automatically.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>tmpdir</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/normalizePath.html'>normalizePath</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span>(), <span class='kw'>winslash</span> <span class='kw'>=</span> <span class='st'>"/"</span>)
<span class='no'>mydata.obj</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generateSyntheticData.html'>generateSyntheticData</a></span>(<span class='kw'>dataset</span> <span class='kw'>=</span> <span class='st'>"mydata"</span>, <span class='kw'>n.vars</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
                                    <span class='kw'>samples.per.cond</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>n.diffexp</span> <span class='kw'>=</span> <span class='fl'>100</span>,
                                    <span class='kw'>output.file</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='no'>tmpdir</span>, <span class='st'>"mydata.rds"</span>))
<span class='fu'><a href='runDiffExp.html'>runDiffExp</a></span>(<span class='kw'>data.file</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='no'>tmpdir</span>, <span class='st'>"mydata.rds"</span>), <span class='kw'>result.extent</span> <span class='kw'>=</span> <span class='st'>"voom.limma"</span>,
           <span class='kw'>Rmdfunction</span> <span class='kw'>=</span> <span class='st'>"voom.limma.createRmd"</span>, <span class='kw'>output.directory</span> <span class='kw'>=</span> <span class='no'>tmpdir</span>,
           <span class='kw'>norm.method</span> <span class='kw'>=</span> <span class='st'>"TMM"</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>processing file: tempcode.Rmd</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |...................................                                   |  50%
#&gt;   ordinary text without R code
#&gt; 
#&gt;   |                                                                              |......................................................................| 100%
#&gt; label: unnamed-chunk-1 (with options) 
#&gt; List of 6
#&gt;  $ echo   : logi TRUE
#&gt;  $ eval   : logi TRUE
#&gt;  $ include: logi TRUE
#&gt;  $ message: logi FALSE
#&gt;  $ error  : logi TRUE
#&gt;  $ warning: logi TRUE
#&gt; 
#&gt; </div><div class='output co'>#&gt; <span class='message'>output file: tempcode.md</span></div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='fu'><a href='runDiffExp.html'>runDiffExp</a></span>(<span class='kw'>data.file</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='no'>tmpdir</span>, <span class='st'>"mydata.rds"</span>), <span class='kw'>result.extent</span> <span class='kw'>=</span> <span class='st'>"edgeR.exact"</span>,
           <span class='kw'>Rmdfunction</span> <span class='kw'>=</span> <span class='st'>"edgeR.exact.createRmd"</span>, <span class='kw'>output.directory</span> <span class='kw'>=</span> <span class='no'>tmpdir</span>,
           <span class='kw'>norm.method</span> <span class='kw'>=</span> <span class='st'>"TMM"</span>,
           <span class='kw'>trend.method</span> <span class='kw'>=</span> <span class='st'>"movingave"</span>, <span class='kw'>disp.type</span> <span class='kw'>=</span> <span class='st'>"tagwise"</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>processing file: tempcode.Rmd</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |...................................                                   |  50%
#&gt;   ordinary text without R code
#&gt; 
#&gt;   |                                                                              |......................................................................| 100%
#&gt; label: unnamed-chunk-1 (with options) 
#&gt; List of 6
#&gt;  $ echo   : logi TRUE
#&gt;  $ eval   : logi TRUE
#&gt;  $ include: logi TRUE
#&gt;  $ message: logi FALSE
#&gt;  $ error  : logi TRUE
#&gt;  $ warning: logi TRUE
#&gt; 
#&gt; </div><div class='output co'>#&gt; <span class='message'>output file: tempcode.md</span></div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='no'>file.table</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>input.files</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='no'>tmpdir</span>,
                         <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"mydata_voom.limma.rds"</span>, <span class='st'>"mydata_edgeR.exact.rds"</span>)),
                         <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='no'>parameters</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>incl.nbr.samples</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>incl.replicates</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>incl.dataset</span> <span class='kw'>=</span> <span class='st'>"mydata"</span>,
                   <span class='kw'>incl.de.methods</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                   <span class='kw'>fdr.threshold</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>tpr.threshold</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>typeI.threshold</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
                   <span class='kw'>ma.threshold</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>fdc.maxvar</span> <span class='kw'>=</span> <span class='fl'>1500</span>, <span class='kw'>overlap.threshold</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
                   <span class='kw'>fracsign.threshold</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>mcc.threshold</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
                   <span class='kw'>nbrtpfp.threshold</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
                   <span class='kw'>comparisons</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"auc"</span>, <span class='st'>"fdr"</span>, <span class='st'>"tpr"</span>, <span class='st'>"ma"</span>, <span class='st'>"correlation"</span>))
<span class='fu'>runComparison</span>(<span class='kw'>file.table</span> <span class='kw'>=</span> <span class='no'>file.table</span>, <span class='kw'>parameters</span> <span class='kw'>=</span> <span class='no'>parameters</span>, <span class='kw'>output.directory</span> <span class='kw'>=</span> <span class='no'>tmpdir</span>)</div><div class='output co'>#&gt; <span class='message'>processing file: /private/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/RtmpS2F5AY/compcodeR_report_2020-05-03-08-10-29.Rmd</span></div><div class='output co'>#&gt; <span class='message'>output file: compcodeR_report_2020-05-03-08-10-29.md</span></div><div class='output co'>#&gt; <span class='message'>Done!</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Charlotte Soneson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


