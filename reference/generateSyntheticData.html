<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generate synthetic count data sets — generateSyntheticData • compcodeR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generate synthetic count data sets — generateSyntheticData"><meta property="og:description" content="Generate synthetic count data sets, following the simulation strategy detailed in Soneson and Delorenzi (2013)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">compcodeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.31.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/compcodeR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/phylocompcodeR.html">Including inter-species measurements in differential expression analysis of RNAseq data with the compcodeR package</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/csoneson/compcodeR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate synthetic count data sets</h1>
    <small class="dont-index">Source: <a href="https://github.com/csoneson/compcodeR/blob/HEAD/R/generateSyntheticData.R" class="external-link"><code>R/generateSyntheticData.R</code></a></small>
    <div class="hidden name"><code>generateSyntheticData.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generate synthetic count data sets, following the simulation strategy detailed in Soneson and Delorenzi (2013).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">generateSyntheticData</span><span class="op">(</span>
  <span class="va">dataset</span>,
  <span class="va">n.vars</span>,
  <span class="va">samples.per.cond</span>,
  <span class="va">n.diffexp</span>,
  repl.id <span class="op">=</span> <span class="fl">1</span>,
  seqdepth <span class="op">=</span> <span class="fl">1e+07</span>,
  minfact <span class="op">=</span> <span class="fl">0.7</span>,
  maxfact <span class="op">=</span> <span class="fl">1.4</span>,
  relmeans <span class="op">=</span> <span class="st">"auto"</span>,
  dispersions <span class="op">=</span> <span class="st">"auto"</span>,
  fraction.upregulated <span class="op">=</span> <span class="fl">1</span>,
  between.group.diffdisp <span class="op">=</span> <span class="cn">FALSE</span>,
  filter.threshold.total <span class="op">=</span> <span class="fl">1</span>,
  filter.threshold.mediancpm <span class="op">=</span> <span class="fl">0</span>,
  fraction.non.overdispersed <span class="op">=</span> <span class="fl">0</span>,
  random.outlier.high.prob <span class="op">=</span> <span class="fl">0</span>,
  random.outlier.low.prob <span class="op">=</span> <span class="fl">0</span>,
  single.outlier.high.prob <span class="op">=</span> <span class="fl">0</span>,
  single.outlier.low.prob <span class="op">=</span> <span class="fl">0</span>,
  effect.size <span class="op">=</span> <span class="fl">1.5</span>,
  output.file <span class="op">=</span> <span class="cn">NULL</span>,
  tree <span class="op">=</span> <span class="cn">NULL</span>,
  prop.var.tree <span class="op">=</span> <span class="fl">1</span>,
  model.process <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BM"</span>, <span class="st">"OU"</span><span class="op">)</span>,
  selection.strength <span class="op">=</span> <span class="fl">0</span>,
  id.condition <span class="op">=</span> <span class="cn">NULL</span>,
  id.species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span> <span class="op">*</span> <span class="va">samples.per.cond</span><span class="op">)</span><span class="op">)</span>,
  check.id.species <span class="op">=</span> <span class="cn">TRUE</span>,
  lengths.relmeans <span class="op">=</span> <span class="cn">NULL</span>,
  lengths.dispersions <span class="op">=</span> <span class="cn">NULL</span>,
  lengths.phylo <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>dataset</dt>
<dd><p>A name or identifier for the data set/simulation settings.</p></dd>
<dt>n.vars</dt>
<dd><p>The initial number of genes in the simulated data set. Based on the filtering conditions (<code>filter.threshold.total</code> and <code>filter.threshold.mediancpm</code>), the number of genes in the final data set may be lower than this number.</p></dd>
<dt>samples.per.cond</dt>
<dd><p>The number of samples in each of the two conditions.</p></dd>
<dt>n.diffexp</dt>
<dd><p>The number of genes simulated to be differentially expressed between the two conditions.</p></dd>
<dt>repl.id</dt>
<dd><p>A replicate ID for the specific simulation instance. Useful for example when generating multiple count matrices with the same simulation settings.</p></dd>
<dt>seqdepth</dt>
<dd><p>The base sequencing depth (total number of mapped reads). This number is multiplied by a value drawn uniformly between <code>minfact</code> and <code>maxfact</code> for each sample to generate data with different actual sequencing depths.</p></dd>
<dt>minfact, maxfact</dt>
<dd><p>The minimum and maximum for the uniform distribution used to generate factors that are multiplied with <code>seqdepth</code> to generate individual sequencing depths for the simulated samples.</p></dd>
<dt>relmeans</dt>
<dd><p>A vector of mean values to use in the simulation of data from the Negative Binomial distribution, or <code>"auto"</code>. Note that these values may be scaled in order to comply with the given sequencing depth. With the default value (<code>"auto"</code>), the mean values are sampled from values estimated from the Pickrell and Cheung data sets. If <code>relmeans</code> is a vector, the provided values will be used as mean values in the simulation for the samples in the first condition. The mean values for the samples in the second condition are generated by combining the <code>relmeans</code> and <code>effect.size</code> arguments.</p></dd>
<dt>dispersions</dt>
<dd><p>A vector or matrix of dispersions to use in the simulation of data from the Negative Binomial distribution, or <code>"auto"</code>. With the default value (<code>"auto"</code>), the dispersion values are sampled from values estimated from the Pickrell and Cheung data sets. If both <code>relmeans</code> and <code>dispersions</code> are set to <code>"auto"</code>, the means and dispersion values are sampled in pairs from the values in these data sets. If <code>dispersions</code> is a single vector, the provided dispersions will be used for simulating data from both conditions. If it is a matrix with two columns, the values in the first column are used for condition 1, and the values in the second column are used for condition 2.</p></dd>
<dt>fraction.upregulated</dt>
<dd><p>The fraction of the differentially expressed genes that is upregulated in condition 2 compared to condition 1.</p></dd>
<dt>between.group.diffdisp</dt>
<dd><p>Whether or not the dispersion should be allowed to be different between the conditions. Only applicable if <code>dispersions</code> is <code>"auto"</code>.</p></dd>
<dt>filter.threshold.total</dt>
<dd><p>The filter threshold on the total count for a gene across all samples. All genes for which the total count across all samples is less than the threshold will be filtered out.</p></dd>
<dt>filter.threshold.mediancpm</dt>
<dd><p>The filter threshold on the median count per million (cpm) for a gene across all samples. All genes for which the median cpm across all samples is less than the threshold will be filtered out.</p></dd>
<dt>fraction.non.overdispersed</dt>
<dd><p>The fraction of the genes that should be simulated according to a Poisson distribution, without overdispersion. The non-overdispersed genes will be divided proportionally between the upregulated, downregulated and non-differentially expressed genes.</p></dd>
<dt>random.outlier.high.prob</dt>
<dd><p>The fraction of 'random' outliers with unusually high counts.</p></dd>
<dt>random.outlier.low.prob</dt>
<dd><p>The fraction of 'random' outliers with unusually low counts.</p></dd>
<dt>single.outlier.high.prob</dt>
<dd><p>The fraction of 'single' outliers with unusually high counts.</p></dd>
<dt>single.outlier.low.prob</dt>
<dd><p>The fraction of 'single' outliers with unusually low counts.</p></dd>
<dt>effect.size</dt>
<dd><p>The strength of the differential expression, i.e., the effect size, between the two conditions. If this is a single number, the effect sizes will be obtained by simulating numbers from an exponential distribution (with rate 1) and adding the results to the <code>effect.size</code>. For genes that are upregulated in the second condition, the mean in the first condition is multiplied by the effect size. For genes that are downregulated in the second condition, the mean in the first condition is divided by the effect size. It is also possible to provide a vector of effect sizes (one for each gene), which will be used as provided. In this case, the <code>fraction.upregulated</code> and <code>n.diffexp</code> arguments will be ignored and the values will be derived from the <code>effect.size</code> vector.</p></dd>
<dt>output.file</dt>
<dd><p>If not <code>NULL</code>, the path to the file where the data object should be saved. The extension should be <code>.rds</code>, if not it will be changed.</p></dd>
<dt>tree</dt>
<dd><p>a dated phylogenetic tree of class <code><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">phylo</a></code> with `samples.per.cond * 2` species.</p></dd>
<dt>prop.var.tree</dt>
<dd><p>the proportion of the common variance explained by the tree for each gene. It can be a scalar, in which case the same parameter is used for all genes. Otherwise it needs to be a vector with length <code>n.vars</code>. Default to 1.</p></dd>
<dt>model.process</dt>
<dd><p>the process to be used for phylogenetic simulations. One of "BM" or "OU", default to "BM".</p></dd>
<dt>selection.strength</dt>
<dd><p>if the process is "OU", the selection strength parameter.</p></dd>
<dt>id.condition</dt>
<dd><p>A named vector, indicating which species is in each condition. Default to first `samples.per.cond` species in condition `1` and others in condition `2`.</p></dd>
<dt>id.species</dt>
<dd><p>A factor giving the species for each sample. If a tree is used, should be a named vector with names matching the taxa of the tree. Default to <code>rep(1, 2*samples.per.cond)</code>, i.e. all the samples come from the same species.</p></dd>
<dt>check.id.species</dt>
<dd><p>Should the species vector be checked against the tree lengths (if provided) ? If TRUE, the function checks that all the samples that share a factor value in <code>id.species</code> that their distance on the tree is zero, i.e. that they are on the same tip of the tree. Default to TRUE.</p></dd>
<dt>lengths.relmeans</dt>
<dd><p>An optional vector of mean values to use in the simulation of lengths from the Negative Binomial distribution. Should be of length n.vars. Default to <code>NULL</code>: the lengths are not taken into account for the simulation. If set to <code>"auto"</code>, the mean length values are sampled from values estimated from the Stern &amp; Crandall (2018) data set.</p></dd>
<dt>lengths.dispersions</dt>
<dd><p>An optional vector of dispersions to use in the simulation of data from the Negative Binomial distribution. Should be of length n.vars. Default to <code>NULL</code>: the lengths are not taken into account for the simulation. If set to <code>"auto"</code>, the dispersion length values are sampled from values estimated from the Stern &amp; Crandall (2018) data set.</p></dd>
<dt>lengths.phylo</dt>
<dd><p>If TRUE, the lengths are simulated according to a phylogenetic Poisson Log-Normal model on the tree, with a BM process. If FALSE, they are simulated according to an iid negative binomial distribution. In both cases, <code>lengths.relmeans</code> and <code>lengths.dispersions</code> are used. Default to TRUE if a tree is provided.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code><a href="compData.html">compData</a></code> object. If <code>output.file</code> is not <code>NULL</code>, the object is saved in the given <code>output.file</code> (which should have an <code>.rds</code> extension).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>In the comparison function, only results obtained for data sets with the same value of the <code>dataset</code> parameter will be compared. Hence, it is important to give the same value of this parameter e.g. to different replicates generated with the same simulation settings.</p>
<p>For more detailed information regarding the different types of outliers, see Soneson and Delorenzi (2013).</p>
<p>Mean and dispersion parameters (if <code>relmeans</code> and/or <code>dispersions</code> is set to <code>"auto"</code>) are sampled from values estimated from the data sets by Pickrell et al (2010) and Cheung et al (2010). The data sets were downloaded from the ReCount web page (Frazee et al (2011)) and processed as detailed by Soneson and Delorenzi (2013).</p>
<p>To get the actual mean value for the Negative Binomial distribution used for the simulation of counts for a given sample, take the column <code>truemeans.S1</code> (or <code>truemeans.S2</code>, if the sample is in condition S2) of the <code>variable.annotations</code> slot, divide by the sum of the same column and multiply with the base sequencing depth (provided in the <code>info.parameters</code> list) and the depth factor for the sample (given in the <code>sample.annotations</code> data frame). Thus, if you have a vector of mean values that you want to provide as the <code>relmeans</code> argument and make sure to use it 'as-is' in the simulation (for condition S1), make sure to set the <code>seqdepth</code> argument to the sum of the values in the <code>relmeans</code> vector, and to set <code>minfact</code> and <code>maxfact</code> equal to 1.</p>
<p>When the <code>tree</code> argument is provided (not <code>NULL</code>),
then the "phylogenetic Poisson log-Normal" model is used for the simulations,
possibly with varying gene lengths across species 
(both <code>lengths.relmeans</code> and <code>lengths.dispersions</code> must be specified
or set to <code>"auto"</code>.)
Phylogenetic simulations use the <code><a href="https://rdrr.io/pkg/phylolm/man/rTrait.html" class="external-link">rTrait</a></code> function
from package <code>phylolm</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Soneson C and Delorenzi M (2013): A comparison of methods for differential expression analysis of RNA-seq data. BMC Bioinformatics 14:91</p>
<p>Cheung VG, Nayak RR, Wang IX, Elwyn S, Cousins SM, Morley M and Spielman RS (2010): Polymorphic cis- and trans-regulation of human gene expression. PLoS Biology 8(9):e1000480</p>
<p>Frazee AC, Langmead B and Leek JT (2011): ReCount: a multi-experiment resource of analysis-ready RNA-seq gene count datasets. BMC Bioinformatics 12:449</p>
<p>Pickrell JK, Marioni JC, Pai AA, Degner JF, Engelhardt BE, Nkadori E, Veyrieras JB, Stephens M, Gilad Y and Pritchard JK (2010): Understanding mechanisms underlying human gene expression variation with RNA sequencing. Nature 464, 768-772</p>
<p>Robles JA, Qureshi SE, Stephen SJ, Wilson SR, Burden CJ and Taylor JM (2012): Efficient experimental design and analysis strategies for the detection of differential expression using RNA-sequencing. BMC Genomics 13:484</p>
<p>Stern DB and Crandall KA (2018): The Evolution of Gene Expression Underlying Vision Loss in Cave Animals. Molecular Biology and Evolution. 35:2005–2014.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Charlotte Soneson</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## RNA-Seq data</span></span>
<span class="r-in"><span class="va">mydata.obj</span> <span class="op">&lt;-</span> <span class="fu">generateSyntheticData</span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"mydata"</span>, n.vars <span class="op">=</span> <span class="fl">1000</span>, </span>
<span class="r-in">                                    samples.per.cond <span class="op">=</span> <span class="fl">5</span>, n.diffexp <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Inter-species RNA-Seq data</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/" class="external-link">ape</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"(((A1:0,A2:0,A3:0):1,B1:1):1,((C1:0,C2:0):1.5,(D1:0,D2:0):1.5):0.5);"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">id.species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"D"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/TCC/man/TCC-class.html" class="external-link">names</a></span><span class="op">(</span><span class="va">id.species</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span></span>
<span class="r-in"><span class="va">mydata.obj</span> <span class="op">&lt;-</span> <span class="fu">generateSyntheticData</span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"mydata"</span>, n.vars <span class="op">=</span> <span class="fl">1000</span>, </span>
<span class="r-in">                                    samples.per.cond <span class="op">=</span> <span class="fl">4</span>, n.diffexp <span class="op">=</span> <span class="fl">100</span>, </span>
<span class="r-in">                                    tree <span class="op">=</span> <span class="va">tree</span>,</span>
<span class="r-in">                                    id.species <span class="op">=</span> <span class="va">id.species</span>,</span>
<span class="r-in">                                    lengths.relmeans <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span class="r-in">                                    lengths.dispersions <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Charlotte Soneson, Paul Bastide, Mélina Gallopin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

