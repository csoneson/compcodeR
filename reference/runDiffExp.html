<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>The main function to run differential expression analysis — runDiffExp • compcodeR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="The main function to run differential expression analysis — runDiffExp"><meta property="og:description" content="The main function for running differential expression analysis (comparing two conditions), using one of the methods interfaced through compcodeR or a user-defined method. Note that the interface functions are provided for convenience and as templates for other, user-defined workflows, and there is no guarantee that the included differential expression code is kept up-to-date with the latest recommendations and best practices for running each of the interfaced methods, or that the chosen settings are suitable in all situations. The user should make sure that the analysis is performed in the way they intend, and check the code that was run, using e.g. the generateCodeHTMLs() function."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">compcodeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.37.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/compcodeR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/phylocompcodeR.html">Including inter-species measurements in differential expression analysis of RNAseq data with the compcodeR package</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/csoneson/compcodeR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>The main function to run differential expression analysis</h1>
    <small class="dont-index">Source: <a href="https://github.com/csoneson/compcodeR/blob/HEAD/R/runDiffExp.R" class="external-link"><code>R/runDiffExp.R</code></a></small>
    <div class="hidden name"><code>runDiffExp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The main function for running differential expression analysis (comparing two conditions), using one of the methods interfaced through <code>compcodeR</code> or a user-defined method. Note that the interface functions are provided for convenience and as templates for other, user-defined workflows, and there is no guarantee that the included differential expression code is kept up-to-date with the latest recommendations and best practices for running each of the interfaced methods, or that the chosen settings are suitable in all situations. The user should make sure that the analysis is performed in the way they intend, and check the code that was run, using e.g. the <code><a href="generateCodeHTMLs.html">generateCodeHTMLs()</a></code> function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">runDiffExp</span><span class="op">(</span></span>
<span>  <span class="va">data.file</span>,</span>
<span>  <span class="va">result.extent</span>,</span>
<span>  <span class="va">Rmdfunction</span>,</span>
<span>  output.directory <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  norm.path <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data.file</dt>
<dd><p>The path to a <code>.rds</code> file containing the data on which the differential expression analysis will be performed, for example a <code>compData</code> object returned from <code><a href="generateSyntheticData.html">generateSyntheticData</a></code>.</p></dd>


<dt>result.extent</dt>
<dd><p>The extension that will be added to the data file name in order to construct the result file name. This can be for example the differential expression method together with a version number.</p></dd>


<dt>Rmdfunction</dt>
<dd><p>A function that creates an Rmd file containing the code that should be run to perform the differential expression analysis. All functions available through <code>compcodeR</code> can be listed using the <code><a href="listcreateRmd.html">listcreateRmd</a></code> function.</p></dd>


<dt>output.directory</dt>
<dd><p>The directory in which the result object will be saved.</p></dd>


<dt>norm.path</dt>
<dd><p>Logical, whether to include the full (absolute) path to the output object in the saved code.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments that will be passed to the <code>Rmdfunction</code>, such as parameter choices for the differential expression method.</p></dd>

</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Charlotte Soneson</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">tmpdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, winslash <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mydata.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="generateSyntheticData.html">generateSyntheticData</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"mydata"</span>, n.vars <span class="op">=</span> <span class="fl">1000</span>, </span></span>
<span class="r-in"><span>                                    samples.per.cond <span class="op">=</span> <span class="fl">5</span>, n.diffexp <span class="op">=</span> <span class="fl">100</span>, </span></span>
<span class="r-in"><span>                                    output.file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tmpdir</span>, <span class="st">"mydata.rds"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="listcreateRmd.html">listcreateRmd</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "DESeq2.createRmd"               "DESeq2.length.createRmd"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] "DSS.createRmd"                  "EBSeq.createRmd"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "NBPSeq.createRmd"               "NOISeq.prenorm.createRmd"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "TCC.createRmd"                  "baySeq.createRmd"              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "edgeR.GLM.createRmd"            "edgeR.exact.createRmd"         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "lengthNorm.limma.createRmd"     "lengthNorm.sva.limma.createRmd"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "logcpm.limma.createRmd"         "phylolm.createRmd"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] "sqrtcpm.limma.createRmd"        "ttest.createRmd"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] "voom.limma.createRmd"           "voom.ttest.createRmd"          </span>
<span class="r-in"><span><span class="fu">runDiffExp</span><span class="op">(</span>data.file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tmpdir</span>, <span class="st">"mydata.rds"</span><span class="op">)</span>, result.extent <span class="op">=</span> <span class="st">"voom.limma"</span>, </span></span>
<span class="r-in"><span>           Rmdfunction <span class="op">=</span> <span class="st">"voom.limma.createRmd"</span>, </span></span>
<span class="r-in"><span>           output.directory <span class="op">=</span> <span class="va">tmpdir</span>, norm.method <span class="op">=</span> <span class="st">"TMM"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> processing file: /private/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/RtmpNoeltZ/tempcode4b826b057ddb.Rmd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/2                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2/2 [unnamed-chunk-1]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> output file: /private/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/RtmpNoeltZ/tempcode4b826b057ddb.md</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## The following list covers the currently available </span></span></span>
<span class="r-in"><span><span class="co">## differential expression methods:</span></span></span>
<span class="r-in"><span><span class="fu">runDiffExp</span><span class="op">(</span>data.file <span class="op">=</span> <span class="st">"mydata.rds"</span>, result.extent <span class="op">=</span> <span class="st">"baySeq"</span>, </span></span>
<span class="r-in"><span>           Rmdfunction <span class="op">=</span> <span class="st">"baySeq.createRmd"</span>,</span></span>
<span class="r-in"><span>           output.directory <span class="op">=</span> <span class="st">"."</span>, norm.method <span class="op">=</span> <span class="st">"edgeR"</span>, </span></span>
<span class="r-in"><span>           equaldisp <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">runDiffExp</span><span class="op">(</span>data.file <span class="op">=</span> <span class="st">"mydata.rds"</span>, result.extent <span class="op">=</span> <span class="st">"DESeq2"</span>, </span></span>
<span class="r-in"><span>           Rmdfunction <span class="op">=</span> <span class="st">"DESeq2.createRmd"</span>,</span></span>
<span class="r-in"><span>           output.directory <span class="op">=</span> <span class="st">"."</span>, fit.type <span class="op">=</span> <span class="st">"parametric"</span>, </span></span>
<span class="r-in"><span>           test <span class="op">=</span> <span class="st">"Wald"</span>, beta.prior <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>           independent.filtering <span class="op">=</span> <span class="cn">TRUE</span>, cooks.cutoff <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>           impute.outliers <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">runDiffExp</span><span class="op">(</span>data.file <span class="op">=</span> <span class="st">"mydata.rds"</span>, result.extent <span class="op">=</span> <span class="st">"DSS"</span>, </span></span>
<span class="r-in"><span>           Rmdfunction <span class="op">=</span> <span class="st">"DSS.createRmd"</span>,</span></span>
<span class="r-in"><span>           output.directory <span class="op">=</span> <span class="st">"."</span>, norm.method <span class="op">=</span> <span class="st">"quantile"</span>, </span></span>
<span class="r-in"><span>           disp.trend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">runDiffExp</span><span class="op">(</span>data.file <span class="op">=</span> <span class="st">"mydata.rds"</span>, result.extent <span class="op">=</span> <span class="st">"EBSeq"</span>, </span></span>
<span class="r-in"><span>           Rmdfunction <span class="op">=</span> <span class="st">"EBSeq.createRmd"</span>,</span></span>
<span class="r-in"><span>           output.directory <span class="op">=</span> <span class="st">"."</span>, norm.method <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">runDiffExp</span><span class="op">(</span>data.file <span class="op">=</span> <span class="st">"mydata.rds"</span>, result.extent <span class="op">=</span> <span class="st">"edgeR.exact"</span>, </span></span>
<span class="r-in"><span>           Rmdfunction <span class="op">=</span> <span class="st">"edgeR.exact.createRmd"</span>,</span></span>
<span class="r-in"><span>           output.directory <span class="op">=</span> <span class="st">"."</span>, norm.method <span class="op">=</span> <span class="st">"TMM"</span>, </span></span>
<span class="r-in"><span>           trend.method <span class="op">=</span> <span class="st">"movingave"</span>, disp.type <span class="op">=</span> <span class="st">"tagwise"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">runDiffExp</span><span class="op">(</span>data.file <span class="op">=</span> <span class="st">"mydata.rds"</span>, result.extent <span class="op">=</span> <span class="st">"edgeR.GLM"</span>, </span></span>
<span class="r-in"><span>           Rmdfunction <span class="op">=</span> <span class="st">"edgeR.GLM.createRmd"</span>,</span></span>
<span class="r-in"><span>           output.directory <span class="op">=</span> <span class="st">"."</span>, norm.method <span class="op">=</span> <span class="st">"TMM"</span>, </span></span>
<span class="r-in"><span>           disp.type <span class="op">=</span> <span class="st">"tagwise"</span>, disp.method <span class="op">=</span> <span class="st">"CoxReid"</span>, </span></span>
<span class="r-in"><span>           trended <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">runDiffExp</span><span class="op">(</span>data.file <span class="op">=</span> <span class="st">"mydata.rds"</span>, result.extent <span class="op">=</span> <span class="st">"logcpm.limma"</span>, </span></span>
<span class="r-in"><span>           Rmdfunction <span class="op">=</span> <span class="st">"logcpm.limma.createRmd"</span>,</span></span>
<span class="r-in"><span>           output.directory <span class="op">=</span> <span class="st">"."</span>, norm.method <span class="op">=</span> <span class="st">"TMM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">runDiffExp</span><span class="op">(</span>data.file <span class="op">=</span> <span class="st">"mydata.rds"</span>, result.extent <span class="op">=</span> <span class="st">"NBPSeq"</span>, </span></span>
<span class="r-in"><span>           Rmdfunction <span class="op">=</span> <span class="st">"NBPSeq.createRmd"</span>,</span></span>
<span class="r-in"><span>           output.directory <span class="op">=</span> <span class="st">"."</span>, norm.method <span class="op">=</span> <span class="st">"TMM"</span>, </span></span>
<span class="r-in"><span>           disp.method <span class="op">=</span> <span class="st">"NBP"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">runDiffExp</span><span class="op">(</span>data.file <span class="op">=</span> <span class="st">"mydata.rds"</span>, result.extent <span class="op">=</span> <span class="st">"NOISeq"</span>, </span></span>
<span class="r-in"><span>           Rmdfunction <span class="op">=</span> <span class="st">"NOISeq.prenorm.createRmd"</span>,</span></span>
<span class="r-in"><span>           output.directory <span class="op">=</span> <span class="st">"."</span>, norm.method <span class="op">=</span> <span class="st">"TMM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">runDiffExp</span><span class="op">(</span>data.file <span class="op">=</span> <span class="st">"mydata.rds"</span>, result.extent <span class="op">=</span> <span class="st">"sqrtcpm.limma"</span>, </span></span>
<span class="r-in"><span>           Rmdfunction <span class="op">=</span> <span class="st">"sqrtcpm.limma.createRmd"</span>,</span></span>
<span class="r-in"><span>           output.directory <span class="op">=</span> <span class="st">"."</span>, norm.method <span class="op">=</span> <span class="st">"TMM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">runDiffExp</span><span class="op">(</span>data.file <span class="op">=</span> <span class="st">"mydata.rds"</span>, result.extent <span class="op">=</span> <span class="st">"TCC"</span>, </span></span>
<span class="r-in"><span>           Rmdfunction <span class="op">=</span> <span class="st">"TCC.createRmd"</span>,</span></span>
<span class="r-in"><span>           output.directory <span class="op">=</span> <span class="st">"."</span>, norm.method <span class="op">=</span> <span class="st">"tmm"</span>, </span></span>
<span class="r-in"><span>           test.method <span class="op">=</span> <span class="st">"edger"</span>, iteration <span class="op">=</span> <span class="fl">3</span>, </span></span>
<span class="r-in"><span>           normFDR <span class="op">=</span> <span class="fl">0.1</span>, floorPDEG <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">runDiffExp</span><span class="op">(</span>data.file <span class="op">=</span> <span class="st">"mydata.rds"</span>, result.extent <span class="op">=</span> <span class="st">"ttest"</span>, </span></span>
<span class="r-in"><span>           Rmdfunction <span class="op">=</span> <span class="st">"ttest.createRmd"</span>,</span></span>
<span class="r-in"><span>           output.directory <span class="op">=</span> <span class="st">"."</span>, norm.method <span class="op">=</span> <span class="st">"TMM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">runDiffExp</span><span class="op">(</span>data.file <span class="op">=</span> <span class="st">"mydata.rds"</span>, result.extent <span class="op">=</span> <span class="st">"voom.limma"</span>, </span></span>
<span class="r-in"><span>           Rmdfunction <span class="op">=</span> <span class="st">"voom.limma.createRmd"</span>, </span></span>
<span class="r-in"><span>           output.directory <span class="op">=</span> <span class="st">"."</span>, norm.method <span class="op">=</span> <span class="st">"TMM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">runDiffExp</span><span class="op">(</span>data.file <span class="op">=</span> <span class="st">"mydata.rds"</span>, result.extent <span class="op">=</span> <span class="st">"voom.ttest"</span>, </span></span>
<span class="r-in"><span>           Rmdfunction <span class="op">=</span> <span class="st">"voom.ttest.createRmd"</span>,</span></span>
<span class="r-in"><span>           output.directory <span class="op">=</span> <span class="st">"."</span>, norm.method <span class="op">=</span> <span class="st">"TMM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Charlotte Soneson, Paul Bastide, Mélina Gallopin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

