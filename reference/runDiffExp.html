<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The main function to run differential expression analysis — runDiffExp • compcodeR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="The main function to run differential expression analysis — runDiffExp" />
<meta property="og:description" content="The main function for running differential expression analysis (comparing two conditions), using one of the methods interfaced through compcodeR or a user-defined method. Note that the interface functions are provided for convenience and as templates for other, user-defined workflows, and there is no guarantee that the included differential expression code is kept up-to-date with the latest recommendations and best practices for running each of the interfaced methods, or that the chosen settings are suitable in all situations. The user should make sure that the analysis is performed in the way they intend, and check the code that was run, using e.g. the generateCodeHTMLs() function." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">compcodeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.27.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/compcodeR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/csoneson/compcodeR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>The main function to run differential expression analysis</h1>
    <small class="dont-index">Source: <a href='https://github.com/csoneson/compcodeR/blob/master/R/runDiffExp.R'><code>R/runDiffExp.R</code></a></small>
    <div class="hidden name"><code>runDiffExp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The main function for running differential expression analysis (comparing two conditions), using one of the methods interfaced through <code>compcodeR</code> or a user-defined method. Note that the interface functions are provided for convenience and as templates for other, user-defined workflows, and there is no guarantee that the included differential expression code is kept up-to-date with the latest recommendations and best practices for running each of the interfaced methods, or that the chosen settings are suitable in all situations. The user should make sure that the analysis is performed in the way they intend, and check the code that was run, using e.g. the <code><a href='generateCodeHTMLs.html'>generateCodeHTMLs()</a></code> function.</p>
    </div>

    <pre class="usage"><span class='fu'>runDiffExp</span><span class='op'>(</span>
  <span class='va'>data.file</span>,
  <span class='va'>result.extent</span>,
  <span class='va'>Rmdfunction</span>,
  output.directory <span class='op'>=</span> <span class='st'>"."</span>,
  norm.path <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data.file</th>
      <td><p>The path to a <code>.rds</code> file containing the data on which the differential expression analysis will be performed, for example a <code>compData</code> object returned from <code><a href='generateSyntheticData.html'>generateSyntheticData</a></code>.</p></td>
    </tr>
    <tr>
      <th>result.extent</th>
      <td><p>The extension that will be added to the data file name in order to construct the result file name. This can be for example the differential expression method together with a version number.</p></td>
    </tr>
    <tr>
      <th>Rmdfunction</th>
      <td><p>A function that creates an Rmd file containing the code that should be run to perform the differential expression analysis. All functions available through <code>compcodeR</code> can be listed using the <code><a href='listcreateRmd.html'>listcreateRmd</a></code> function.</p></td>
    </tr>
    <tr>
      <th>output.directory</th>
      <td><p>The directory in which the result object will be saved.</p></td>
    </tr>
    <tr>
      <th>norm.path</th>
      <td><p>Logical, whether to include the full (absolute) path to the output object in the saved code.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments that will be passed to the <code>Rmdfunction</code>, such as parameter choices for the differential expression method.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Charlotte Soneson</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>tmpdir</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/normalizePath.html'>normalizePath</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, winslash <span class='op'>=</span> <span class='st'>"/"</span><span class='op'>)</span>
<span class='va'>mydata.obj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='generateSyntheticData.html'>generateSyntheticData</a></span><span class='op'>(</span>dataset <span class='op'>=</span> <span class='st'>"mydata"</span>, n.vars <span class='op'>=</span> <span class='fl'>1000</span>, 
                                    samples.per.cond <span class='op'>=</span> <span class='fl'>5</span>, n.diffexp <span class='op'>=</span> <span class='fl'>100</span>, 
                                    output.file <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>tmpdir</span>, <span class='st'>"mydata.rds"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='listcreateRmd.html'>listcreateRmd</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] "baySeq.createRmd"         "DESeq2.createRmd"        
#&gt;  [3] "DSS.createRmd"            "EBSeq.createRmd"         
#&gt;  [5] "edgeR.exact.createRmd"    "edgeR.GLM.createRmd"     
#&gt;  [7] "logcpm.limma.createRmd"   "NBPSeq.createRmd"        
#&gt;  [9] "NOISeq.prenorm.createRmd" "sqrtcpm.limma.createRmd" 
#&gt; [11] "TCC.createRmd"            "ttest.createRmd"         
#&gt; [13] "voom.limma.createRmd"     "voom.ttest.createRmd"    </div><div class='input'><span class='fu'>runDiffExp</span><span class='op'>(</span>data.file <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>tmpdir</span>, <span class='st'>"mydata.rds"</span><span class='op'>)</span>, result.extent <span class='op'>=</span> <span class='st'>"voom.limma"</span>, 
           Rmdfunction <span class='op'>=</span> <span class='st'>"voom.limma.createRmd"</span>, 
           output.directory <span class='op'>=</span> <span class='va'>tmpdir</span>, norm.method <span class='op'>=</span> <span class='st'>"TMM"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>processing file: tempcode.Rmd</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |...................................                                   |  50%
#&gt;   ordinary text without R code
#&gt; 
#&gt;   |                                                                              |......................................................................| 100%
#&gt; label: unnamed-chunk-1 (with options) 
#&gt; List of 6
#&gt;  $ echo   : logi TRUE
#&gt;  $ eval   : logi TRUE
#&gt;  $ include: logi TRUE
#&gt;  $ message: logi FALSE
#&gt;  $ error  : logi TRUE
#&gt;  $ warning: logi TRUE
#&gt; 
#&gt; </div><div class='output co'>#&gt; <span class='message'>output file: tempcode.md</span></div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>## The following list covers the currently available </span>
<span class='co'>## differential expression methods:</span>
<span class='fu'>runDiffExp</span><span class='op'>(</span>data.file <span class='op'>=</span> <span class='st'>"mydata.rds"</span>, result.extent <span class='op'>=</span> <span class='st'>"baySeq"</span>, 
           Rmdfunction <span class='op'>=</span> <span class='st'>"baySeq.createRmd"</span>,
           output.directory <span class='op'>=</span> <span class='st'>"."</span>, norm.method <span class='op'>=</span> <span class='st'>"edgeR"</span>, 
           equaldisp <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>runDiffExp</span><span class='op'>(</span>data.file <span class='op'>=</span> <span class='st'>"mydata.rds"</span>, result.extent <span class='op'>=</span> <span class='st'>"DESeq2"</span>, 
           Rmdfunction <span class='op'>=</span> <span class='st'>"DESeq2.createRmd"</span>,
           output.directory <span class='op'>=</span> <span class='st'>"."</span>, fit.type <span class='op'>=</span> <span class='st'>"parametric"</span>, 
           test <span class='op'>=</span> <span class='st'>"Wald"</span>, beta.prior <span class='op'>=</span> <span class='cn'>TRUE</span>, 
           independent.filtering <span class='op'>=</span> <span class='cn'>TRUE</span>, cooks.cutoff <span class='op'>=</span> <span class='cn'>TRUE</span>, 
           impute.outliers <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>runDiffExp</span><span class='op'>(</span>data.file <span class='op'>=</span> <span class='st'>"mydata.rds"</span>, result.extent <span class='op'>=</span> <span class='st'>"DSS"</span>, 
           Rmdfunction <span class='op'>=</span> <span class='st'>"DSS.createRmd"</span>,
           output.directory <span class='op'>=</span> <span class='st'>"."</span>, norm.method <span class='op'>=</span> <span class='st'>"quantile"</span>, 
           disp.trend <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>runDiffExp</span><span class='op'>(</span>data.file <span class='op'>=</span> <span class='st'>"mydata.rds"</span>, result.extent <span class='op'>=</span> <span class='st'>"EBSeq"</span>, 
           Rmdfunction <span class='op'>=</span> <span class='st'>"EBSeq.createRmd"</span>,
           output.directory <span class='op'>=</span> <span class='st'>"."</span>, norm.method <span class='op'>=</span> <span class='st'>"median"</span><span class='op'>)</span>
<span class='fu'>runDiffExp</span><span class='op'>(</span>data.file <span class='op'>=</span> <span class='st'>"mydata.rds"</span>, result.extent <span class='op'>=</span> <span class='st'>"edgeR.exact"</span>, 
           Rmdfunction <span class='op'>=</span> <span class='st'>"edgeR.exact.createRmd"</span>,
           output.directory <span class='op'>=</span> <span class='st'>"."</span>, norm.method <span class='op'>=</span> <span class='st'>"TMM"</span>, 
           trend.method <span class='op'>=</span> <span class='st'>"movingave"</span>, disp.type <span class='op'>=</span> <span class='st'>"tagwise"</span><span class='op'>)</span>
<span class='fu'>runDiffExp</span><span class='op'>(</span>data.file <span class='op'>=</span> <span class='st'>"mydata.rds"</span>, result.extent <span class='op'>=</span> <span class='st'>"edgeR.GLM"</span>, 
           Rmdfunction <span class='op'>=</span> <span class='st'>"edgeR.GLM.createRmd"</span>,
           output.directory <span class='op'>=</span> <span class='st'>"."</span>, norm.method <span class='op'>=</span> <span class='st'>"TMM"</span>, 
           disp.type <span class='op'>=</span> <span class='st'>"tagwise"</span>, disp.method <span class='op'>=</span> <span class='st'>"CoxReid"</span>, 
           trended <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>runDiffExp</span><span class='op'>(</span>data.file <span class='op'>=</span> <span class='st'>"mydata.rds"</span>, result.extent <span class='op'>=</span> <span class='st'>"logcpm.limma"</span>, 
           Rmdfunction <span class='op'>=</span> <span class='st'>"logcpm.limma.createRmd"</span>,
           output.directory <span class='op'>=</span> <span class='st'>"."</span>, norm.method <span class='op'>=</span> <span class='st'>"TMM"</span><span class='op'>)</span>
<span class='fu'>runDiffExp</span><span class='op'>(</span>data.file <span class='op'>=</span> <span class='st'>"mydata.rds"</span>, result.extent <span class='op'>=</span> <span class='st'>"NBPSeq"</span>, 
           Rmdfunction <span class='op'>=</span> <span class='st'>"NBPSeq.createRmd"</span>,
           output.directory <span class='op'>=</span> <span class='st'>"."</span>, norm.method <span class='op'>=</span> <span class='st'>"TMM"</span>, 
           disp.method <span class='op'>=</span> <span class='st'>"NBP"</span><span class='op'>)</span>
<span class='fu'>runDiffExp</span><span class='op'>(</span>data.file <span class='op'>=</span> <span class='st'>"mydata.rds"</span>, result.extent <span class='op'>=</span> <span class='st'>"NOISeq"</span>, 
           Rmdfunction <span class='op'>=</span> <span class='st'>"NOISeq.prenorm.createRmd"</span>,
           output.directory <span class='op'>=</span> <span class='st'>"."</span>, norm.method <span class='op'>=</span> <span class='st'>"TMM"</span><span class='op'>)</span>
<span class='fu'>runDiffExp</span><span class='op'>(</span>data.file <span class='op'>=</span> <span class='st'>"mydata.rds"</span>, result.extent <span class='op'>=</span> <span class='st'>"sqrtcpm.limma"</span>, 
           Rmdfunction <span class='op'>=</span> <span class='st'>"sqrtcpm.limma.createRmd"</span>,
           output.directory <span class='op'>=</span> <span class='st'>"."</span>, norm.method <span class='op'>=</span> <span class='st'>"TMM"</span><span class='op'>)</span>
<span class='fu'>runDiffExp</span><span class='op'>(</span>data.file <span class='op'>=</span> <span class='st'>"mydata.rds"</span>, result.extent <span class='op'>=</span> <span class='st'>"TCC"</span>, 
           Rmdfunction <span class='op'>=</span> <span class='st'>"TCC.createRmd"</span>,
           output.directory <span class='op'>=</span> <span class='st'>"."</span>, norm.method <span class='op'>=</span> <span class='st'>"tmm"</span>, 
           test.method <span class='op'>=</span> <span class='st'>"edger"</span>, iteration <span class='op'>=</span> <span class='fl'>3</span>, 
           normFDR <span class='op'>=</span> <span class='fl'>0.1</span>, floorPDEG <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>
<span class='fu'>runDiffExp</span><span class='op'>(</span>data.file <span class='op'>=</span> <span class='st'>"mydata.rds"</span>, result.extent <span class='op'>=</span> <span class='st'>"ttest"</span>, 
           Rmdfunction <span class='op'>=</span> <span class='st'>"ttest.createRmd"</span>,
           output.directory <span class='op'>=</span> <span class='st'>"."</span>, norm.method <span class='op'>=</span> <span class='st'>"TMM"</span><span class='op'>)</span>
<span class='fu'>runDiffExp</span><span class='op'>(</span>data.file <span class='op'>=</span> <span class='st'>"mydata.rds"</span>, result.extent <span class='op'>=</span> <span class='st'>"voom.limma"</span>, 
           Rmdfunction <span class='op'>=</span> <span class='st'>"voom.limma.createRmd"</span>, 
           output.directory <span class='op'>=</span> <span class='st'>"."</span>, norm.method <span class='op'>=</span> <span class='st'>"TMM"</span><span class='op'>)</span>
<span class='fu'>runDiffExp</span><span class='op'>(</span>data.file <span class='op'>=</span> <span class='st'>"mydata.rds"</span>, result.extent <span class='op'>=</span> <span class='st'>"voom.ttest"</span>, 
           Rmdfunction <span class='op'>=</span> <span class='st'>"voom.ttest.createRmd"</span>,
           output.directory <span class='op'>=</span> <span class='st'>"."</span>, norm.method <span class='op'>=</span> <span class='st'>"TMM"</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Charlotte Soneson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


